<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLIPZ. - Dashboard</title>
    
    <!-- Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- YouTube Iframe API -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        page: '#050505',
                        brand: '#7C3AED',
                        pill: '#1A1A1A',
                        border: '#ffffff1a',
                        card: '#0A0A0B', 
                        text: '#E5E5E5',
                        subtext: '#A1A1AA',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    backgroundImage: {
                        'purple-glow': 'radial-gradient(circle at 0% 50%, rgba(124, 58, 237, 0.15) 0%, transparent 50%)',
                    },
                    animation: {
                        'spin-slow': 'spin 3s linear infinite',
                    }
                }
            }
        }
    </script>

    <style>
        /* Base Reset */
        body {
            background-color: #050505;
            color: #ffffff;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* Background Grain */
        .bg-grain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* Ambient Glow */
        .ambient-light {
            position: fixed;
            top: 0;
            left: -20%;
            width: 50%;
            height: 100%;
            background: radial-gradient(circle, rgba(124, 58, 237, 0.12) 0%, rgba(5, 5, 5, 0) 70%);
            filter: blur(80px);
            z-index: -2;
            pointer-events: none;
        }

        /* Navbar User Pill */
        .user-pill {
            background-color: #121212;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 9999px;
            padding: 4px 16px 4px 6px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: border-color 0.2s;
        }
        .user-pill:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* Dashboard Card Styles */
        .dash-card {
            background-color: rgba(10, 10, 11, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
            backdrop-filter: blur(10px);
        }

        /* Input Field - Integrated Style */
        .input-premium {
            background-color: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #d4d4d8;
            border-radius: 9999px;
            transition: all 0.3s ease;
        }
        .input-premium:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.05);
            border-color: rgba(124, 58, 237, 0.5);
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1);
        }

        /* Button Styles - Premium Pill */
        .btn-primary-pill {
            background-color: #ffffff;
            color: #000000;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }
        .btn-primary-pill:hover {
            background-color: #e5e5e5;
            transform: translateY(-1px);
        }

        .btn-secondary-pill {
            background-color: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #a1a1aa;
            border-radius: 9999px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-secondary-pill:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: rgba(255, 255, 255, 0.05);
        }

        .btn-cyan-hover:not(:disabled):hover {
            border-color: rgba(8, 145, 178, 0.5);
            background-color: rgba(8, 145, 178, 0.1);
            color: #22d3ee;
        }
        
        .btn-green-hover:not(:disabled):hover {
            border-color: rgba(5, 150, 105, 0.5);
            background-color: rgba(5, 150, 105, 0.1);
            color: #34d399;
        }

        .btn-danger-text {
            color: #52525b;
            transition: all 0.2s;
            font-size: 0.875rem;
            cursor: pointer;
        }
        .btn-danger-text:hover {
            color: #ef4444;
        }
        .btn-danger-text:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            color: #3f3f46;
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Loader */
        .loader {
            border: 3px solid rgba(255,255,255,0.1);
            border-left-color: #7C3AED;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="selection:bg-brand selection:text-white">

    <!-- Background Elements -->
    <div class="bg-grain"></div>
    <div class="ambient-light"></div>

    <!-- NAVBAR -->
    <nav class="fixed w-full z-50 pt-6 px-8 top-0 bg-[#050505]/80 backdrop-blur-md border-b border-white/5 pb-4">
        <div class="max-w-[1400px] mx-auto flex justify-between items-center">
            <div class="flex items-center">
                <span class="font-bold text-2xl tracking-tight text-white">CLIPZ<span class="text-brand">.</span></span>
            </div>

            <div class="flex items-center gap-12">
                <div class="hidden md:flex items-center gap-8">
                    <a href="https://clipzcreatif-create.github.io/ClipzID/#" class="text-sm font-medium text-subtext hover:text-white transition-colors">Home</a>
                    <a href="#" class="text-sm font-medium text-white transition-colors">Edit</a>
                    <a href="#" class="text-sm font-medium text-subtext hover:text-white transition-colors">Konsultasi</a>
                </div>

                <div class="user-pill cursor-pointer">
                    <div class="text-right leading-tight">
                        <div class="text-[11px] font-bold text-brand">Pro User</div>
                        <div class="text-xs font-bold text-white">Joko</div>
                    </div>
                    <div class="w-9 h-9 rounded-full bg-zinc-800 border border-white/10 overflow-hidden relative">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=faces" alt="Profile" class="w-full h-full object-cover opacity-80 hover:opacity-100 transition-opacity">
                    </div>
                    <i data-lucide="chevron-down" class="w-4 h-4 text-zinc-500 ml-1"></i>
                </div>
            </div>
        </div>
    </nav>

    <!-- MAIN DASHBOARD CONTENT -->
    <main class="min-h-screen pt-32 pb-12 px-6">
        <div class="max-w-[1200px] mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6 h-full">
            
            <!-- LEFT COLUMN (Video & Controls) -->
            <div class="lg:col-span-2 flex flex-col gap-6">
                
                <!-- 1. Video Player Area -->
                <div id="player-container" class="dash-card aspect-video flex flex-col items-center justify-center text-zinc-600 relative overflow-hidden group">
                    <!-- Placeholder State -->
                    <div id="video-placeholder" class="flex flex-col items-center justify-center w-full h-full absolute inset-0 bg-[#0A0A0B] z-10 transition-opacity duration-500">
                        <div class="absolute inset-0 bg-gradient-to-tr from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
                        <i data-lucide="play-circle" class="w-16 h-16 mb-4 opacity-30 group-hover:opacity-100 group-hover:scale-110 group-hover:text-white transition-all duration-300"></i>
                        <p class="text-sm font-medium opacity-50 group-hover:opacity-80 transition-opacity">Preview Area</p>
                    </div>
                    
                    <!-- YouTube Player (Hidden Initially) -->
                    <div id="youtube-player" class="w-full h-full absolute inset-0 z-0"></div>
                </div>

                <!-- 2. Controls Panel -->
                <div class="dash-card p-8">
                    <!-- Input Row -->
                    <div class="flex flex-col md:flex-row gap-4 mb-8 items-center relative">
                        <div class="flex-1 w-full relative">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-500">
                                <i data-lucide="link" class="w-4 h-4"></i>
                            </div>
                            <input id="yt-input" type="text" placeholder="Tempelkan link YouTube di sini..." class="input-premium w-full pl-11 pr-4 py-3.5 text-sm placeholder-zinc-600">
                            <!-- Error Message Bubble -->
                            <div id="error-message" class="absolute -bottom-6 left-2 text-xs text-red-500 hidden">Link tidak valid</div>
                        </div>
                        
                        <button id="load-btn" class="w-full md:w-auto btn-primary-pill py-3.5 px-8 text-sm flex items-center justify-center gap-2 whitespace-nowrap">
                            <span>Muat Video</span>
                            <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>

                    <!-- Divider -->
                    <div class="h-px bg-gradient-to-r from-transparent via-white/10 to-transparent mb-8"></div>

                    <!-- Action Buttons Grid -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-between items-center">
                        <div class="flex gap-4 w-full sm:w-auto">
                            <!-- Auto Clip -->
                            <button id="auto-clip-btn" disabled class="flex-1 sm:flex-none btn-secondary-pill btn-cyan-hover py-3 px-6 text-sm flex items-center justify-center gap-2">
                                <i data-lucide="sparkles" class="w-4 h-4"></i>
                                Auto Clip
                            </button>
                            
                            <!-- Download -->
                            <button id="download-btn" disabled class="flex-1 sm:flex-none btn-secondary-pill btn-green-hover py-3 px-6 text-sm flex items-center justify-center gap-2">
                                <i data-lucide="download" class="w-4 h-4"></i>
                                Download
                            </button>
                        </div>

                        <!-- Delete -->
                        <button id="delete-btn" disabled class="btn-danger-text flex items-center gap-2 mt-4 sm:mt-0 hover:underline decoration-red-500/30 underline-offset-4">
                            <i data-lucide="trash" class="w-3.5 h-3.5"></i>
                            Hapus Klip
                        </button>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN (Recommendations) -->
            <div class="lg:col-span-1 h-full">
                <div class="dash-card p-6 h-full min-h-[400px] flex flex-col relative overflow-hidden">
                    <div class="flex items-center justify-between mb-6 z-10">
                        <h2 class="text-lg font-semibold text-white">Rekomendasi</h2>
                        <span id="clip-count" class="text-[10px] uppercase tracking-wider text-brand font-bold bg-brand/10 px-2 py-1 rounded-md border border-brand/20 hidden">0 Clips</span>
                    </div>
                    
                    <!-- Clip List Container -->
                    <div id="clip-list-container" class="flex-1 overflow-y-auto custom-scrollbar z-10 space-y-3 max-h-[600px]">
                        <!-- Empty State -->
                        <div id="empty-state" class="flex flex-col items-center justify-center text-center p-8 border border-dashed border-zinc-800 rounded-2xl bg-zinc-900/20 h-full min-h-[300px]">
                            <div class="text-zinc-600 space-y-3">
                                <div class="w-12 h-12 rounded-full bg-zinc-900 flex items-center justify-center mx-auto border border-zinc-800">
                                    <i data-lucide="film" class="w-5 h-5 opacity-50"></i>
                                </div>
                                <div class="space-y-1">
                                    <p class="text-sm font-medium text-zinc-400">Daftar klip kosong</p>
                                    <p class="text-xs opacity-50">Silakan muat video baru</p>
                                </div>
                            </div>
                        </div>

                        <!-- Loading State (Hidden) -->
                        <div id="loading-state" class="hidden flex flex-col items-center justify-center text-center p-8 h-full min-h-[300px]">
                            <div class="loader mb-4 border-l-brand"></div>
                            <p class="text-sm text-zinc-400">AI sedang menganalisis...</p>
                        </div>
                    </div>

                    <!-- Background Decor -->
                    <div class="absolute -bottom-20 -right-20 w-64 h-64 bg-brand/5 rounded-full blur-3xl pointer-events-none"></div>
                </div>
            </div>

        </div>
    </main>

    <!-- LOGIC SCRIPT -->
    <script>
        // State Variables
        let player;
        let currentVideoId = null;
        let currentVideoTitle = "";
        let videoDuration = 0;
        let clipsData = [];

        // DOM Elements
        const ytInput = document.getElementById('yt-input');
        const loadBtn = document.getElementById('load-btn');
        const autoClipBtn = document.getElementById('auto-clip-btn');
        const downloadBtn = document.getElementById('download-btn');
        const deleteBtn = document.getElementById('delete-btn');
        const videoPlaceholder = document.getElementById('video-placeholder');
        const errorMessage = document.getElementById('error-message');
        const clipListContainer = document.getElementById('clip-list-container');
        const emptyState = document.getElementById('empty-state');
        const loadingState = document.getElementById('loading-state');
        const clipCount = document.getElementById('clip-count');

        // Initial Icons
        lucide.createIcons();

        // 1. YouTube API Ready
        function onYouTubeIframeAPIReady() {
            // API Loaded
        }

        // 2. Load Video Logic
        loadBtn.addEventListener('click', () => {
            const url = ytInput.value.trim();
            const videoId = getYouTubeVideoId(url);

            if (videoId) {
                currentVideoId = videoId;
                errorMessage.classList.add('hidden');
                loadPlayer(videoId);
                resetClips();
                // Enable Buttons
                autoClipBtn.disabled = false;
                downloadBtn.disabled = false; // Enabled for full download
            } else {
                errorMessage.classList.remove('hidden');
            }
        });

        function getYouTubeVideoId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function loadPlayer(videoId) {
            videoPlaceholder.style.zIndex = '-1'; // Hide placeholder
            if (player) {
                player.loadVideoById(videoId);
            } else {
                player = new YT.Player('youtube-player', {
                    height: '100%',
                    width: '100%',
                    videoId: videoId,
                    playerVars: { 'autoplay': 1, 'controls': 1, 'rel': 0 },
                    events: {
                        'onReady': onPlayerReady
                    }
                });
            }
        }

        function onPlayerReady(event) {
            currentVideoTitle = event.target.getVideoData().title;
            videoDuration = event.target.getDuration();
        }

        // 3. Auto Clip Simulation Logic
        autoClipBtn.addEventListener('click', async () => {
            if (!currentVideoId) return;

            // Show Loading
            emptyState.classList.add('hidden');
            loadingState.classList.remove('hidden');
            
            // Simulate AI Delay
            setTimeout(() => {
                const simulatedClips = getSimulatedAIClips(currentVideoTitle || "Video Content", videoDuration || 600);
                clipsData = simulatedClips;
                renderClips();
                loadingState.classList.add('hidden');
                deleteBtn.disabled = false; // Enable delete button
            }, 2000);
        });

        function getSimulatedAIClips(title, duration) {
            const fallbackTitles = ["Viral Hook Moment", "Best Punchline", "Key Insight", "Funny Reaction", "Conclusion"];
            const generatedClips = [];
            const numClips = Math.floor(Math.random() * 3) + 3; // 3 to 5 clips
            
            for (let i = 0; i < numClips; i++) {
                const start = Math.floor(Math.random() * (duration - 30));
                const end = start + Math.floor(Math.random() * 20) + 10; // 10-30s duration
                
                generatedClips.push({
                    title: fallbackTitles[i % fallbackTitles.length],
                    start: formatTime(start),
                    end: formatTime(end),
                    duration: (end - start) + "s",
                    timestampStart: start
                });
            }
            return generatedClips;
        }

        function formatTime(seconds) {
            const date = new Date(0);
            date.setSeconds(seconds);
            return date.toISOString().substr(14, 5);
        }

        // 4. Render Clips to Sidebar
        function renderClips() {
            // clear current list (except states)
            const existingClips = document.querySelectorAll('.clip-item');
            existingClips.forEach(el => el.remove());

            if (clipsData.length > 0) {
                clipCount.innerText = clipsData.length + " Clips";
                clipCount.classList.remove('hidden');

                clipsData.forEach((clip, index) => {
                    const clipEl = document.createElement('div');
                    clipEl.className = 'clip-item p-3 rounded-xl bg-white/5 border border-white/5 hover:border-brand/30 hover:bg-white/10 transition cursor-pointer group flex gap-3 items-start';
                    clipEl.onclick = () => seekTo(clip.timestampStart);

                    clipEl.innerHTML = `
                        <div class="w-20 h-12 bg-black rounded-lg overflow-hidden flex-shrink-0 relative">
                            <img src="https://img.youtube.com/vi/${currentVideoId}/mqdefault.jpg" class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition">
                            <div class="absolute bottom-0.5 right-0.5 bg-black/80 px-1 rounded text-[8px] text-white">${clip.duration}</div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h4 class="text-sm font-medium text-zinc-200 truncate group-hover:text-brand transition">${clip.title}</h4>
                            <p class="text-[10px] text-zinc-500 mt-0.5">${clip.start} - ${clip.end}</p>
                        </div>
                        <div class="flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition">
                             <button onclick="mockDownload(event)" class="text-zinc-500 hover:text-white"><i data-lucide="download" class="w-3.5 h-3.5"></i></button>
                        </div>
                    `;
                    clipListContainer.appendChild(clipEl);
                });
                lucide.createIcons();
            }
        }

        // 5. Helper Functions
        function seekTo(seconds) {
            if (player) {
                player.seekTo(seconds, true);
                player.playVideo();
            }
        }

        function resetClips() {
            clipsData = [];
            const existingClips = document.querySelectorAll('.clip-item');
            existingClips.forEach(el => el.remove());
            emptyState.classList.remove('hidden');
            loadingState.classList.add('hidden');
            clipCount.classList.add('hidden');
            deleteBtn.disabled = true;
        }

        window.mockDownload = (e) => {
            e.stopPropagation();
            alert("Memulai download klip...");
        }

        deleteBtn.addEventListener('click', () => {
            if (confirm("Hapus semua klip yang dihasilkan?")) {
                resetClips();
            }
        });
        
        downloadBtn.addEventListener('click', () => {
            alert("Mendownload video full...");
        });

    </script>
</body>
</html>
